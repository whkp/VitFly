# VitFlyè½¨è¿¹æ•°æ®åˆ†æå·¥å…·

æœ¬åˆ†æå·¥å…·åŒ…æä¾›äº†ç”¨äºåˆ†æå’Œå¯è§†åŒ–é£è¡Œå™¨è½¨è¿¹æ•°æ®çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œä¸“é—¨é’ˆå¯¹ä¸åŒæœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆExpertã€ViTã€ViT+LSTMã€ConvNetã€RobustViT+LSTMï¼‰çš„æ€§èƒ½æ¯”è¾ƒã€‚

## ğŸ“ æ•°æ®ç»“æ„

```
data/
â”œâ”€â”€ expert/          # ä¸“å®¶ç³»ç»Ÿæ•°æ®
â”œâ”€â”€ vit/             # ViTæ¨¡å‹æ•°æ®
â”œâ”€â”€ vitlstm/         # ViT+LSTMæ¨¡å‹æ•°æ®
â”œâ”€â”€ convnet/         # ConvNetæ¨¡å‹æ•°æ®
â””â”€â”€ robustVitLstm/   # RobustViT+LSTMæ¨¡å‹æ•°æ®
    â”œâ”€â”€ 0/           # è¯•éªŒ0
    â”‚   â”œâ”€â”€ data.csv # è½¨è¿¹æ•°æ®æ–‡ä»¶
    â”‚   â””â”€â”€ *.png    # å›¾åƒæ–‡ä»¶
    â”œâ”€â”€ 1/           # è¯•éªŒ1
    â”‚   â”œâ”€â”€ data.csv
    â”‚   â””â”€â”€ *.png
    â””â”€â”€ ...
```

### CSVæ•°æ®æ ¼å¼
æ¯ä¸ª`data.csv`æ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š
- `pos_x`, `pos_y`, `pos_z`: ä½ç½®åæ ‡ (ç±³)
- `vel_x`, `vel_y`, `vel_z`: é€Ÿåº¦åˆ†é‡ (ç±³/ç§’)
- `desired_vel`: æœŸæœ›é€Ÿåº¦ (ç±³/ç§’)
- `is_collide`: ç¢°æ’æ ‡è®° (0/1)
- å…¶ä»–ä¼ æ„Ÿå™¨å’Œæ§åˆ¶æ•°æ®åˆ—

## ï¿½ æ•°æ®è¦è¦æ±‚è¯¦ç»†è¯´æ˜

### è½¨è¿¹æ•°æ® (data.csv) å¿…éœ€å­—æ®µ

| å­—æ®µå | ç±»å‹ | å•ä½ | è¯´æ˜ |
|--------|------|------|------|
| `timestamp` | float | ç§’ | æ—¶é—´æˆ³ |
| `desired_vel` | float | m/s | æœŸæœ›å‰å‘é€Ÿåº¦ |
| `pos_x`, `pos_y`, `pos_z` | float | ç±³ | æ— äººæœºä½ç½®åæ ‡ |
| `vel_x`, `vel_y`, `vel_z` | float | m/s | æ— äººæœºé€Ÿåº¦åˆ†é‡ |
| `velcmd_x`, `velcmd_y`, `velcmd_z` | float | m/s | é€Ÿåº¦å‘½ä»¤ï¼ˆç”¨äºåŠ é€Ÿåº¦åˆ†æï¼‰ |
| `is_collide` | bool/int | - | ç¢°æ’æ ‡å¿— (True/1=ç¢°æ’, False/0=æ— ç¢°æ’) |

### éšœç¢ç‰©æ•°æ® (static_obstacles.csv) æ ¼å¼

| åˆ—ç´¢å¼• | å†…å®¹ | è¯´æ˜ |
|--------|------|------|
| ç¬¬1åˆ— | ç´¢å¼• | é€šå¸¸è¢«è·³è¿‡ |
| ç¬¬2-4åˆ— | x, y, z | éšœç¢ç‰©ä¸­å¿ƒä½ç½®ï¼ˆç±³ï¼‰ |
| ç¬¬5åˆ— | radius | éšœç¢ç‰©åŠå¾„ï¼ˆç±³ï¼‰ |

## ğŸ› ï¸ ä¸»è¦è„šæœ¬åŠŸèƒ½

### plot.py - CSVè½¨è¿¹ç»¼åˆåˆ†æå™¨

è¿™æ˜¯ä¸»è¦çš„åˆ†æè„šæœ¬ï¼Œæä¾›å…¨é¢çš„è½¨è¿¹æ•°æ®åˆ†æåŠŸèƒ½ã€‚

#### æ ¸å¿ƒç±»å’ŒåŠŸèƒ½ï¼š

**TrajectoryAnalyzerç±»**
- **æ•°æ®åŠ è½½**: è‡ªåŠ¨æ‰«æå­æ–‡ä»¶å¤¹ï¼ŒåŠ è½½æ‰€æœ‰CSVæ–‡ä»¶
- **ç¢°æ’åˆ†æ**: è®¡ç®—ç¢°æ’ç‡ã€ç¢°æ’äº‹ä»¶æ•°é‡ã€å¹³å‡ç¢°æ’æŒç»­æ—¶é—´
- **è½¨è¿¹ç»Ÿè®¡**: æŒ‰Xè½´åˆ†æ®µè®¡ç®—ä½ç½®ç»Ÿè®¡ä¿¡æ¯ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ï¼‰
- **å¯è§†åŒ–**: æ”¯æŒ2Då’Œ3Dè½¨è¿¹ç»˜åˆ¶ï¼ŒåŒ…å«éšœç¢ç‰©æ˜¾ç¤º

**ä¸»è¦æ–¹æ³•**:
```python
# åˆå§‹åŒ–åˆ†æå™¨
analyzer = TrajectoryAnalyzer(data_folder, model_name, obs_folder)

# åˆ†æç¢°æ’
collision_stats = analyzer.analyze_collisions()

# è®¡ç®—è½¨è¿¹ç»Ÿè®¡
traj_stats = analyzer.compute_trajectory_statistics(x_bins=60)

# ç»˜åˆ¶2Dè½¨è¿¹ï¼ˆXYæˆ–XZå¹³é¢ï¼‰
analyzer.plot_2d_trajectory(ax, plane='xy', color='blue')

# ç»˜åˆ¶3Dè½¨è¿¹
analyzer.plot_3d_trajectory(ax, color='blue', with_obstacles=True)
```

#### ç”Ÿæˆçš„å¯è§†åŒ–å›¾è¡¨ï¼š

1. **ç¢°æ’åˆ†æå›¾è¡¨** (`collision_analysis.png`)
   - ç¢°æ’ç‡æ¯”è¾ƒ
   - ç¢°æ’äº‹ä»¶æ•°é‡
   - å¹³å‡ç¢°æ’æŒç»­æ—¶é—´
   - å®‰å…¨æ’å

2. **2Dè½¨è¿¹æŠ•å½±** 
   - XYå¹³é¢è½¨è¿¹ (`trajectory_xy_plane.png`)
   - XZå¹³é¢è½¨è¿¹ (`trajectory_xz_plane.png`)
   - åŒ…å«ç½®ä¿¡åŒºé—´ï¼ˆå‡å€¼Â±æ ‡å‡†å·®ï¼‰

3. **3Dè½¨è¿¹å¯è§†åŒ–** (`trajectory_3d.png`)
   - ä¸‰ç»´ç©ºé—´è½¨è¿¹å¯¹æ¯”
   - é™æ€éšœç¢ç‰©æ˜¾ç¤º

4. **æ€§èƒ½æŒ‡æ ‡çƒ­åŠ›å›¾** (`metrics_heatmap.png`)
   - æ ‡å‡†åŒ–æŒ‡æ ‡æ¯”è¾ƒ
   - ç»Ÿè®¡æ‘˜è¦è¡¨ (`statistical_summary.csv`)

**æ•°æ®æº**ï¼šCSVæ ¼å¼çš„è½¨è¿¹æ•°æ®æ–‡ä»¶

**æ ¸å¿ƒç±»**ï¼š
- `TrajectoryAnalyzer` - å•ä¸ªæ¨¡å‹çš„è½¨è¿¹åˆ†æå™¨
- `analyze_all_models()` - æ‰¹é‡åˆ†ææ‰€æœ‰æ¨¡å‹

**ä¸»è¦åŠŸèƒ½**ï¼š
- ç¢°æ’äº‹ä»¶æ£€æµ‹å’Œç»Ÿè®¡åˆ†æ
- è½¨è¿¹ç»Ÿè®¡è®¡ç®—ï¼ˆæŒ‰Xè½´åˆ†æ®µï¼‰
- 2Dè½¨è¿¹æŠ•å½±ï¼ˆXYå’ŒXZå¹³é¢ï¼‰
- 3Dè½¨è¿¹å¯è§†åŒ–ï¼ˆå«éšœç¢ç‰©ï¼‰
- æ€§èƒ½æŒ‡æ ‡çƒ­åŠ›å›¾
- ç»¼åˆåˆ†ææŠ¥å‘Šç”Ÿæˆ

**è¾“å‡ºå›¾åƒ**ï¼š
1. `collision_analysis.png/pdf` - ç¢°æ’åˆ†æç»¼åˆå›¾ï¼ˆ2Ã—2å­å›¾ï¼‰
   - ç¢°æ’ç‡å¯¹æ¯”æŸ±çŠ¶å›¾
   - ç¢°æ’äº‹ä»¶æ•°é‡
   - å¹³å‡ç¢°æ’æŒç»­æ—¶é—´
   - å®‰å…¨è¯„åˆ†æ’å

2. `trajectory_xy_plane.png/pdf` - XYå¹³é¢è½¨è¿¹å¯¹æ¯”
   - æ˜¾ç¤ºè½¨è¿¹å‡å€¼æ›²çº¿
   - é˜´å½±åŒºåŸŸè¡¨ç¤ºæ ‡å‡†å·®èŒƒå›´

3. `trajectory_xz_plane.png/pdf` - XZå¹³é¢è½¨è¿¹å¯¹æ¯”
   - æ˜¾ç¤ºé«˜åº¦å˜åŒ–è¶‹åŠ¿

4. `trajectory_3d.png/pdf` - 3Dè½¨è¿¹å¯¹æ¯”ï¼ˆå«éšœç¢ç‰©ï¼‰
   - ä¸‰ç»´ç©ºé—´è½¨è¿¹å¯è§†åŒ–
   - é™æ€éšœç¢ç‰©æ˜¾ç¤ºï¼ˆæ¤­çƒä½“ï¼‰

5. `metrics_heatmap.png/pdf` - æ€§èƒ½æŒ‡æ ‡çƒ­åŠ›å›¾
   - æ ‡å‡†åŒ–æŒ‡æ ‡æ¯”è¾ƒ

6. `statistical_summary.csv` - ç»Ÿè®¡æ‘˜è¦è¡¨æ ¼

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
cd analysis/
python plot.py
```

æˆ–åœ¨ä»£ç ä¸­è°ƒç”¨ï¼š
```python
from plot import analyze_all_models

# è¿è¡Œç»¼åˆåˆ†æ
analyze_all_models(
    data_directory="./data",
    obs_folder="/path/to/obstacles"
)
```

---

## ğŸ“Š æ ¹ç›®å½•åˆ†æè„šæœ¬

### analyze_evaluation_results.py - YAMLè¯„ä¼°ç»“æœåˆ†æå™¨

**ä½ç½®**ï¼šé¡¹ç›®æ ¹ç›®å½• `/home/namy/catkin_ws/src/vitfly/analyze_evaluation_results.py`

**æ•°æ®æº**ï¼šYAMLæ ¼å¼çš„è¯„ä¼°ç»“æœæ–‡ä»¶

**æ ¸å¿ƒç±»**ï¼š
- `EvaluationResultsAnalyzer` - è¯„ä¼°ç»“æœåˆ†æå™¨

**ä¸»è¦åŠŸèƒ½**ï¼š
- ä»YAMLæ–‡ä»¶åŠ è½½è¯„ä¼°æ•°æ®
- è®¡ç®—æˆåŠŸç‡ã€ç¢°æ’ç‡ã€æ—¶é—´æ•ˆç‡
- ç”Ÿæˆå¤šç»´åº¦æ€§èƒ½å¯¹æ¯”å›¾è¡¨
- åˆ›å»ºæ€§èƒ½çƒ­åŠ›å›¾
- ç”Ÿæˆåˆ†ææŠ¥å‘Š

**è¾“å‡ºå›¾åƒ**ï¼š
1. `success_rates_comparison.png` - æˆåŠŸç‡å¯¹æ¯”æ›²çº¿
2. `crash_rates_comparison.png` - ç¢°æ’ç‡å¯¹æ¯”æ›²çº¿
3. `time_efficiency_comparison.png` - æ—¶é—´æ•ˆç‡å¯¹æ¯”æ›²çº¿
4. `success_rate_heatmap.png` - æˆåŠŸç‡çƒ­åŠ›å›¾
5. `crash_rate_heatmap.png` - ç¢°æ’ç‡çƒ­åŠ›å›¾
6. `comprehensive_comparison.png` - ç»¼åˆæ€§èƒ½å¯¹æ¯”ï¼ˆ2Ã—2å­å›¾ï¼‰
7. `performance_summary_table.png` - æ€§èƒ½æ±‡æ€»è¡¨
8. `performance_summary.csv` - æ•°æ®è¡¨æ ¼
9. `analysis_report.txt` - åˆ†ææŠ¥å‘Š

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python analyze_evaluation_results.py
```

**é…ç½®å‚æ•°**ï¼š
- `results_dir`: è¯„ä¼°ç»“æœç›®å½•ï¼Œé»˜è®¤ `"./evaluation_results"`
- `output_dir`: è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ `"./evaluation_analysis"`
- `velocities`: æµ‹è¯•é€Ÿåº¦åˆ—è¡¨ï¼Œé»˜è®¤ `[3.0, 4.0, 5.0, 6.0, 7.0]`

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¿«é€Ÿå¼€å§‹

**åˆ†æCSVè½¨è¿¹æ•°æ®**ï¼š
```bash
cd analysis/
python plot.py
```

**åˆ†æYAMLè¯„ä¼°ç»“æœ**ï¼š
```bash
cd /home/namy/catkin_ws/src/vitfly/
python analyze_evaluation_results.py
```

### è‡ªå®šä¹‰åˆ†æ

```python
# å¯¼å…¥å¿…è¦çš„æ¨¡å—
from plot import analyze_all_models
from result_plot import analyze_model_comparison

# è¿è¡Œç»¼åˆåˆ†æ
analyze_all_models(data_directory="./data", 
                  obs_folder="path/to/obstacles")

# è¿è¡Œæ¨¡å‹å¯¹æ¯”
analyze_model_comparison(data_directory="./data", 
                        output_dir="./custom_plots")
```

### å‚æ•°é…ç½®

**å…³é”®å‚æ•°**:
- `data_directory`: æ•°æ®ç›®å½•è·¯å¾„
- `obs_folder`: éšœç¢ç‰©æ•°æ®æ–‡ä»¶å¤¹ï¼ˆå¯é€‰ï¼‰
- `output_dir`: è¾“å‡ºå›¾è¡¨ç›®å½•
- `x_bins`: Xè½´åˆ†æ®µæ•°é‡ï¼ˆé»˜è®¤60ï¼‰
- `speed_filter`: é€Ÿåº¦è¿‡æ»¤å™¨ï¼ˆå¯é€‰ï¼‰

## ğŸ“Š è¾“å‡ºæ–‡ä»¶è¯´æ˜

### å›¾åƒæ–‡ä»¶
- **PNGæ ¼å¼**: é«˜åˆ†è¾¨ç‡ï¼ˆ300 DPIï¼‰ç”¨äºå±•ç¤º
- **PDFæ ¼å¼**: çŸ¢é‡å›¾ç”¨äºè®ºæ–‡å‘è¡¨

### æ•°æ®æ–‡ä»¶
- **CSVæ ¼å¼**: åŒ…å«æ‰€æœ‰è®¡ç®—çš„ç»Ÿè®¡æŒ‡æ ‡
- **å¯ç›´æ¥å¯¼å…¥Excelæˆ–å…¶ä»–åˆ†æå·¥å…·**

### ç”Ÿæˆçš„æŒ‡æ ‡

**ç¢°æ’ç›¸å…³æŒ‡æ ‡**:
- ç¢°æ’ç‡ï¼ˆæŒ‰è¯•éªŒå’Œæ—¶é—´æ­¥è®¡ç®—ï¼‰
- ç¢°æ’äº‹ä»¶æ•°é‡
- å¹³å‡ç¢°æ’æŒç»­æ—¶é—´
- æˆåŠŸç‡

**è½¨è¿¹ç›¸å…³æŒ‡æ ‡**:
- ä½ç½®ç»Ÿè®¡ï¼ˆå‡å€¼ã€æ ‡å‡†å·®ï¼‰
- è½¨è¿¹å¹³æ»‘åº¦
- è½¨è¿¹å˜å¼‚æ€§

## ğŸ”§ è‡ªå®šä¹‰å’Œæ‰©å±•

### æ·»åŠ æ–°æ¨¡å‹

1. åœ¨`model_configs`å­—å…¸ä¸­æ·»åŠ æ–°æ¨¡å‹é…ç½®:
```python
model_configs = {
    'new_model': {'color': 'purple', 'name': 'New Model'},
    # ...existing models
}
```

2. ç¡®ä¿æ•°æ®æ–‡ä»¶å¤¹ç»“æ„ä¸ç°æœ‰æ¨¡å‹ä¸€è‡´

### ä¿®æ”¹å¯è§†åŒ–æ ·å¼

```python
# ä¿®æ”¹é¢œè‰²æ–¹æ¡ˆ
plt.style.use('seaborn')  # æˆ–å…¶ä»–æ ·å¼

# è‡ªå®šä¹‰é¢œè‰²
custom_colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7']
```

### æ·»åŠ æ–°çš„åˆ†ææŒ‡æ ‡

```python
def custom_analysis_function(data):
    # å®ç°è‡ªå®šä¹‰åˆ†æé€»è¾‘
    return custom_metrics

# åœ¨ä¸»åˆ†æå‡½æ•°ä¸­è°ƒç”¨
custom_results = custom_analysis_function(trajectory_data)
```

## ğŸ“ˆ åˆ†æç»“æœè§£è¯»

### æ€§èƒ½æŒ‡æ ‡è§£é‡Š

1. **ç¢°æ’ç‡**: 
   - è¯•éªŒç¢°æ’ç‡ï¼šå‘ç”Ÿç¢°æ’çš„è¯•éªŒæ¯”ä¾‹
   - æ—¶é—´æ­¥ç¢°æ’ç‡ï¼šæ‰€æœ‰æ—¶é—´æ­¥ä¸­ç¢°æ’çš„æ¯”ä¾‹

2. **è½¨è¿¹å˜å¼‚æ€§**:
   - Y/Zæ ‡å‡†å·®ï¼šåæ˜ è½¨è¿¹åœ¨æ¨ªå‘/çºµå‘çš„ç¨³å®šæ€§
   - æ ‡å‡†å·®è¶Šå°è¡¨ç¤ºè½¨è¿¹è¶Šç¨³å®š

3. **å®‰å…¨è¯„åˆ†**:
   - åŸºäºç¢°æ’ç‡è®¡ç®—ï¼š100% - ç¢°æ’ç‡
   - è¶Šé«˜è¡¨ç¤ºæ¨¡å‹è¶Šå®‰å…¨

### æ¨¡å‹æ€§èƒ½æ’å

é€šå¸¸æŒ‰ä»¥ä¸‹é¡ºåºè¯„ä¼°æ¨¡å‹æ€§èƒ½ï¼š
1. **å®‰å…¨æ€§**: ç¢°æ’ç‡ï¼ˆè¶Šä½è¶Šå¥½ï¼‰
2. **ç¨³å®šæ€§**: è½¨è¿¹å˜å¼‚æ€§ï¼ˆè¶Šå°è¶Šå¥½ï¼‰
3. **æ•ˆç‡**: æˆåŠŸå®Œæˆä»»åŠ¡çš„æ¯”ä¾‹ï¼ˆè¶Šé«˜è¶Šå¥½ï¼‰

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åŠ è½½å¤±è´¥**:
   - æ£€æŸ¥CSVæ–‡ä»¶æ ¼å¼å’Œåˆ—å
   - ç¡®è®¤æ–‡ä»¶è·¯å¾„æ­£ç¡®
   - éªŒè¯æ•°æ®æ–‡ä»¶å¤¹ç»“æ„

2. **ç»˜å›¾é”™è¯¯**:
   - æ£€æŸ¥matplotlibç‰ˆæœ¬å…¼å®¹æ€§
   - ç¡®è®¤æœ‰è¶³å¤Ÿçš„å†…å­˜å¤„ç†å¤§å‹æ•°æ®é›†
   - éªŒè¯è¾“å‡ºç›®å½•å†™æƒé™

3. **å†…å­˜ä¸è¶³**:
   - å‡å°‘æ•°æ®é‡‡æ ·æ•°é‡
   - åˆ†æ‰¹å¤„ç†å¤§å‹æ•°æ®é›†
   - ä½¿ç”¨æ•°æ®è¿‡æ»¤å™¨

### ä¾èµ–è¦æ±‚

```bash
pip install numpy pandas matplotlib seaborn
```

## ğŸ“ æ›´æ–°æ—¥å¿—

- **v2.0**: å®Œå…¨é‡æ„ï¼Œæ”¯æŒå®é™…CSVæ•°æ®æ ¼å¼
- **v1.1**: æ·»åŠ 3Då¯è§†åŒ–å’Œéšœç¢ç‰©æ”¯æŒ
- **v1.0**: åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€è½¨è¿¹åˆ†æåŠŸèƒ½

## ï¿½ è„šæœ¬å¯¹æ¯æ¯”æ€»ç»“

| è„šæœ¬ | ä¸»è¦ç”¨é€” | è¾“å‡ºå›¾åƒæ•°é‡ | æ˜¯å¦éœ€è¦éšœç¢ç‰©æ•°æ® | é€‚ç”¨åœºæ™¯ |
|------|----------|--------------|-------------------|----------|
| `gen_collision_plots.py` | ç¢°æ’ç»Ÿè®¡åˆ†æ | 2 | å¦ | å¿«é€Ÿè¯„ä¼°ç¢°æ’æ€§èƒ½ |
| `gen_metrics.py` | æ€§èƒ½æŒ‡æ ‡è®¡ç®— | 1-3 | å¦ | å¤šç»´åº¦æ€§èƒ½è¯„ä¼° |
| `gen_plots.py` | è½¨è¿¹å¯è§†åŒ– | 3 | æ˜¯ï¼ˆå¯é€‰ï¼‰ | è½¨è¿¹è·¯å¾„åˆ†æ |
| `plot.py` | ç»¼åˆåˆ†æ | 6 | æ˜¯ï¼ˆå¯é€‰ï¼‰ | å®Œæ•´åˆ†ææŠ¥å‘Š |
| `result_plot.py` | æ¨¡å‹å¯¹æ¯” | 5 | å¦ | å¤šæ¨¡å‹æ€§èƒ½å¯¹æ¯” |

## ğŸ¯ æ¨èå·¥ä½œæµç¨‹

### æ ‡å‡†åˆ†ææµç¨‹

**æ­¥éª¤1ï¼šåˆ†æCSVè½¨è¿¹æ•°æ®ï¼ˆå¾®è§‚åˆ†æï¼‰**
```bash
cd analysis/
python plot.py
```
ç”Ÿæˆè½¨è¿¹å¯è§†åŒ–ã€ç¢°æ’åˆ†æã€æ€§èƒ½çƒ­åŠ›å›¾ç­‰

**æ­¥éª¤2ï¼šåˆ†æYAMLè¯„ä¼°ç»“æœï¼ˆå®è§‚åˆ†æï¼‰**
```bash
cd /home/namy/catkin_ws/src/vitfly/
python analyze_evaluation_results.py
```
ç”ŸæˆæˆåŠŸç‡ã€ç¢°æ’ç‡ã€æ—¶é—´æ•ˆç‡å¯¹æ¯”ç­‰

### ä¸¤ä¸ªè„šæœ¬çš„åŒºåˆ«

| ç‰¹æ€§ | plot.py | analyze_evaluation_results.py |
|------|---------|-------------------------------|
| **æ•°æ®æº** | CSVè½¨è¿¹æ–‡ä»¶ | YAMLè¯„ä¼°ç»“æœ |
| **åˆ†æç²’åº¦** | å¾®è§‚ï¼ˆæ¯ä¸ªæ—¶é—´æ­¥ï¼‰ | å®è§‚ï¼ˆæ¯æ¬¡è¯•éªŒï¼‰ |
| **ä¸»è¦å†…å®¹** | ä½ç½®ã€é€Ÿåº¦ã€è½¨è¿¹å½¢çŠ¶ | æˆåŠŸç‡ã€ç¢°æ’æ¬¡æ•°ã€å®Œæˆæ—¶é—´ |
| **éšœç¢ç‰©æ˜¾ç¤º** | æ”¯æŒ | ä¸æ”¯æŒ |
| **é€‚ç”¨é˜¶æ®µ** | è¯¦ç»†è½¨è¿¹åˆ†æ | è¯„ä¼°ç»“æœæ±‡æ€» |

## ğŸ’¡ ä½¿ç”¨æŠ€å·§

### 1. æ‰¹é‡å¤„ç†å¤šä¸ªæ•°æ®é›†
```python
# åˆ›å»ºæ‰¹å¤„ç†è„šæœ¬
datasets = ['logs_trees', 'logs_spheres', 'logs_no_md']
for dataset in datasets:
    vit_folder = f"./{dataset}/vit/"
    # ... è¿è¡Œåˆ†æ
```

### 2. è‡ªå®šä¹‰é€Ÿåº¦èŒƒå›´
```python
# åœ¨gen_collision_plots.pyä¸­ä¿®æ”¹
vels = [3., 3.5, 4., 4.5, 5., 5.5, 6., 6.5, 7.]  # ç»†ç²’åº¦
# æˆ–
vels = [3., 5., 7.]  # ç²—ç²’åº¦
```

### 3. è°ƒæ•´å›¾åƒè´¨é‡
```python
# ä¿®æ”¹DPIè®¾ç½®
plt.savefig('output.png', dpi=300)  # æ ‡å‡†è´¨é‡
plt.savefig('output.png', dpi=900)  # é«˜è´¨é‡ï¼ˆæ–‡ä»¶è¾ƒå¤§ï¼‰
```

### 4. å†…å­˜ä¼˜åŒ–
```python
# å¯¹äºå¤§æ•°æ®é›†ï¼Œä½¿ç”¨é‡‡æ ·
if len(positions) > 1000:
    sample_indices = np.random.choice(len(positions), 1000, replace=False)
    positions = positions[sample_indices]
```

## âš ï¸ å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### é”™è¯¯1ï¼šæ‰¾ä¸åˆ°æ•°æ®æ–‡ä»¶
```
FileNotFoundError: [Errno 2] No such file or directory: './logs/vit/0/data.csv'
```
**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥æ•°æ®æ–‡ä»¶å¤¹è·¯å¾„å’Œç»“æ„æ˜¯å¦æ­£ç¡®

### é”™è¯¯2ï¼šåˆ—åä¸åŒ¹é…
```
KeyError: 'is_collide'
```
**è§£å†³æ–¹æ¡ˆ**ï¼šç¡®è®¤CSVæ–‡ä»¶åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼Œæ£€æŸ¥åˆ—åæ‹¼å†™

### é”™è¯¯3ï¼šé€Ÿåº¦å€¼ä¸åŒ¹é…
```
Warning: No data found for velocity 3.0
```
**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥æ•°æ®ä¸­çš„ `desired_vel` å€¼ï¼Œè°ƒæ•´è„šæœ¬ä¸­çš„ `vels` åˆ—è¡¨

### é”™è¯¯4ï¼šå†…å­˜ä¸è¶³
```
MemoryError: Unable to allocate array
```
**è§£å†³æ–¹æ¡ˆ**ï¼š
- å‡å°‘æ•°æ®é‡‡æ ·æ•°é‡
- åˆ†æ‰¹å¤„ç†æ•°æ®
- å¢åŠ ç³»ç»Ÿå†…å­˜

### é”™è¯¯5ï¼šéšœç¢ç‰©æ•°æ®åŠ è½½å¤±è´¥
```
Error loading obstacle data
```
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `static_obstacles.csv` æ–‡ä»¶æ ¼å¼
- ç¡®è®¤éšœç¢ç‰©æ–‡ä»¶å¤¹è·¯å¾„æ­£ç¡®
- éªŒè¯CSVæ–‡ä»¶ä¸ä¸ºç©º

## ğŸ“ˆ è¾“å‡ºå›¾åƒè¯´æ˜

### å›¾åƒå‘½åè§„èŒƒ
- `*_collision_plots.*` - ç¢°æ’ç›¸å…³ç»Ÿè®¡
- `*_metadata_sr.*` - æˆåŠŸç‡ç›¸å…³
- `traj_2d_*.* ` - 2Dè½¨è¿¹æŠ•å½±
- `traj_3d.*` - 3Dè½¨è¿¹å¯è§†åŒ–
- `*_comparison.*` - æ¨¡å‹å¯¹æ¯”å›¾

### å›¾åƒæ ¼å¼é€‰æ‹©
- **PNGæ ¼å¼**ï¼šç”¨äºæ¼”ç¤ºã€æŠ¥å‘Šã€ç½‘é¡µå±•ç¤º
- **PDFæ ¼å¼**ï¼šç”¨äºè®ºæ–‡å‘è¡¨ã€é«˜è´¨é‡æ‰“å°
- **EPSæ ¼å¼**ï¼šç”¨äºæŸäº›æœŸåˆŠè¦æ±‚ï¼ˆéƒ¨åˆ†è„šæœ¬æ”¯æŒï¼‰

## ğŸ”¬ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰åˆ†ææŒ‡æ ‡
```python
# åœ¨TrajectoryAnalyzerç±»ä¸­æ·»åŠ æ–°æ–¹æ³•
def custom_metric(self):
    # å®ç°è‡ªå®šä¹‰åˆ†æé€»è¾‘
    return custom_results
```

### æ·»åŠ æ–°çš„å¯è§†åŒ–
```python
# åˆ›å»ºè‡ªå®šä¹‰ç»˜å›¾å‡½æ•°
def plot_custom_analysis(data, output_path):
    fig, ax = plt.subplots()
    # ç»˜å›¾é€»è¾‘
    plt.savefig(output_path)
```

### å¯¼å‡ºæ•°æ®ç”¨äºå…¶ä»–å·¥å…·
```python
# å¯¼å‡ºä¸ºJSONæ ¼å¼
import json
with open('analysis_results.json', 'w') as f:
    json.dump(results_dict, f, indent=2)

# å¯¼å‡ºä¸ºExcelæ ¼å¼
df.to_excel('analysis_results.xlsx', index=False)
```
